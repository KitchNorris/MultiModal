# MultiModal

üçΩÔ∏è Multimodal Calorie Prediction


–°—Ö–µ–º–∞ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏: —Ç–µ–∫—Å—Ç + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ + –º–∞—Å—Å–∞ ‚Üí —Ä–µ–≥—Ä–µ—Å—Å–æ—Ä ‚Üí –∫–∞–ª–æ—Ä–∏–∏

üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç—å –±–ª—é–¥ –Ω–∞ –æ—Å–Ω–æ–≤–µ:

–§–æ—Ç–æ –±–ª—é–¥–∞

–°–ø–∏—Å–∫–∞ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤

–ú–∞—Å—Å—ã –±–ª—é–¥–∞

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏.

üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–¢–µ–∫—Å—Ç–æ–≤–∞—è –≤–µ—Ç–∫–∞: BERT (bert-base-uncased) ‚Üí –ª–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è

–í–∏–∑—É–∞–ª—å–Ω–∞—è –≤–µ—Ç–∫–∞: ResNet50 (pretrained=True) ‚Üí –ª–∏–Ω–µ–π–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è

–ú–∞—Å—Å–∞ –±–ª—é–¥–∞: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä—É–µ—Ç—Å—è –∏ –ø—Ä–æ–µ—Ü–∏—Ä—É–µ—Ç—Å—è

–§—å—é–∂–Ω: –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ ‚Üí MLP —Ä–µ–≥—Ä–µ—Å—Å–æ—Ä ‚Üí —Å–∫–∞–ª—è—Ä –∫–∞–ª–æ—Ä–∏–π–Ω–æ—Å—Ç–∏

‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
git clone <repo_url>
cd <repo_name>
python -m venv venv
source venv/bin/activate  # Linux/Mac
pip install -r requirements.txt

üóÇ –î–∞–Ω–Ω—ã–µ

dish.csv ‚Äî –º–µ—Ç–∫–∏ –∫–∞–ª–æ—Ä–∏–π, –º–∞—Å—Å–∞, –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã

ingredients.csv ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤

images/ ‚Äî –ø–∞–ø–∫–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ <dish_id>/rgb.png

üèãÔ∏è‚Äç‚ôÇÔ∏è –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
from train import train

train_losses, val_maes = train()


–†–∞–∑–º–æ—Ä–æ–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–ª–æ–µ–≤ BERT –∏ ResNet

Optimizer: AdamW —Å —Ä–∞–∑–Ω—ã–º–∏ LR –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π, –≤–∏–∑—É–∞–ª—å–Ω–æ–π –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –≤–µ—Ç–æ–∫

Loss: L1Loss (MAE)

üîç –ò–Ω—Ñ–µ—Ä–µ–Ω—Å
model = MultimodalModel(Config)
model.load_state_dict(torch.load(Config.SAVE_PATH))
model.eval()

output = model(input_ids=input_ids,
               attention_mask=attention_mask,
               image=image_tensor,
               mass=mass_tensor)
print(f"Predicted calories: {output.item()}")

üé® –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

RandomCrop, HorizontalFlip, VerticalFlip, Rotate

Affine, BrightnessContrast, GaussianBlur, MotionBlur, GaussNoise

Normalize, ToTensorV2

üìä –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

–ú–æ–¥–µ–ª—å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏–µ —Ç–µ–∫—Å—Ç—ã + –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è + —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏

–ú–æ–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –¥–æ–æ–±—É—á–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—É—é/–≤–∏–∑—É–∞–ª—å–Ω—É—é –≤–µ—Ç–∫–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞
